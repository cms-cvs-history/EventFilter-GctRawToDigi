

process gctVmeToDigi = {

//  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  service = MessageLogger {
    untracked vstring destinations = { "debug.log" }
    untracked PSet debug.log = { untracked string threshold = "DEBUG" } 
    untracked vstring debugModules =  { "TextToRaw", "GctRawToDigi"}
  }

  source = EmptySource { }

  untracked PSet maxEvents = { untracked int32 input = 3564 }

  module gctRaw = TextToRaw {
    untracked string filename = "increasingValueTower2-gct-0-0-1.txt"
    untracked int32 GctFedId = 745
  }

  include "EventFilter/GctRawToDigi/data/l1GctHwDigis.cfi"
  replace l1GctHwDigis.inputLabel = gctRaw
  replace l1GctHwDigis.verbose = true
  replace l1GctHwDigis.unpackFibres = true
  replace l1GctHwDigis.unpackInternEm = true

  module dumpRaw = DumpFEDRawDataProduct { 
    untracked vint32 feds = { 745 }
    untracked bool dumpPayload = true
  }

  include "L1Trigger/L1GctAnalyzer/data/dumpGctDigis.cfi"
  replace dumpGctDigis.rawInput = l1GctHwDigis
  replace dumpGctDigis.emuRctInput = l1RctEmulDigis
  replace dumpGctDigis.emuGctInput = l1GctEmulDigis
  replace dumpGctDigis.doHardware = true
  replace dumpGctDigis.doEmulated = false
  replace dumpGctDigis.doRctEm = true
  replace dumpGctDigis.doInternEm = false
  replace dumpGctDigis.doEm = true
  replace dumpGctDigis.doJets = true

  path p = { gctRaw, dumpRaw, l1GctHwDigis, dumpGctDigis }

  module outputEvents = PoolOutputModule {
    untracked vstring outputCommands = {
      "drop *",
      "keep *_l1GctHwDigis_*_*",
      "keep *_gctRaw_*_*"
    }
    untracked string fileName = "gctDigis.root"
  }

  endpath outpath = { outputEvents }

}
